# 有限元素法簡介
+ 作者: HsiupoYeh
+ 更新日期: 2025-10-18

---

### 有限元素法 (Finite Element Method, FEM)簡介
有限元素法 (FEM) 是一種強大的數值方法，廣泛應用於求解工程和物理學中的偏微分方程式 (PDEs)。這些方程式描述了各種物理現象如何隨空間和時間變化，像是熱傳導、流體流動、結構應力或電磁場。
在地電阻影像剖面法(Electrical Resistivity Tomography, ERT) 中，我們需要求解的核心 PDE 是： `∇⋅(σ∇u)=−Iδ(r−rₛ)`。
由於地下地層的電阻率(`ρ`)或導電率(`σ`)通常是高度非均勻且複雜的，傳統的解析方法很難求解這個 PDE。這正是 FEM 派上用場的地方：它能精確地將地層劃分成數百甚至數千個小元素，每個元素可以有自己獨特的 σ 值，然後透過數值方法來計算整個地下空間的電位分佈。 這種能力使得 FEM 成為地電阻影像剖面法以及許多其他地球物理、工程和科學領域中求解 PDEs 不可或缺的工具。

---

### 物理量與單位

| 物理量            | 符號           | 單位名稱     | 單位符號   |
| :--------------   | :------------ | :---------  | :--------- |
| **電位**          | u             | 伏特         | V          |
| **電導率**        | σ             | 西門子每米    | S/m        |
| **電流強度**      | I             | 安培           | A          |
| **空間位置**      | r, rₛ         | 米             | m          |
| **狄拉克 δ 函數** | δ             | 1/三次方米      | 1/m³       |


### FEM 求解的主要輸入與輸出
+ 核心 PDE: `(∇ ⋅ (σ∇u) = -Iδ(r - rₛ))`
+ 假設: 離散的計算區域(Mesh)、邊界條件
+ 已知: 介質電性屬性(`σ`)、電流源強度(`I`)及位置(`rₛ`)
+ 求解: 電位場(`u`)
+ 主要輸入輸出如下表：

| 類別   | 項目 (Item)             | 內容 (Content)                               | 用途 (Purpose)                                     |
| :----- | :---------------------- | :------------------------------------------- | :------------------------------------------------- |
| **輸入** | **1. 求解域的網格 (Mesh)** | 構成計算區域的幾何形狀、尺寸、元素類型 (如三角形、四面體) 及節點分佈。 | 定義問題的空間範圍和離散化方式。                 |
| **輸入** | **2. 邊界條件** | 網格邊界上電位或電流的設定（例如： **絕緣邊界條件或稱諾依曼邊界條件(Neumann Boundary Condition)** 、 **固定電位邊界條件或稱狄利克雷邊界條件(Dirichlet 
| **輸入** | **3. 介質電性屬性 (`σ`)** | 網格中每個元素的**電導率 (`σ`)** 值。 | 描述電流在不同材料中流動的難易程度。雖然ERT中習慣探討電阻率(`ρ`)，但計算多數使用電導率(`σ`)。             |
| **輸入** | **4. 電流源 (`I`, `rₛ`)** | **電流源強度 (`I`)** 及電流注入點的 **空間位置 (`rₛ`)**。 | 提供電場的「驅動力」，指定能量注入點。             |
Boundary Condition)** 、 **混合邊界條件(Mixed Boundary Condition)**）。 | 確保數學問題有唯一解，並模擬系統與外界的交互。   |
| **輸出** | **電位分佈 (u)** | 網格中每個節點的**電位 (`u`)** 值。             | 提供整個求解域內的電位場分佈，是進一步計算電場、電流或模擬測量的基礎。 |

### 數值模擬中的邊界條件

| 條件名稱 | 數學分類 | 物理意義 | 在 ERT 中的應用 |
| :--- | :--- | :--- | :--- |
| **絕緣邊界條件** | 第二類邊界條件: 諾依曼邊界條件(Neumann Boundary Condition) | 模擬一個**不導電**的邊界（法向電流通量為零）。 | 通常用於**地表**（除了電極點）。 |
| **固定電位邊界條件** | 第一類邊界條件: 狄利克雷邊界條件(Dirichlet Boundary Condition) | 模擬一個具有**已知電位值**的邊界。 | 有時用於**側面和底部邊界**，例如：想模擬無窮遠處電位為0，則設計一個相當遠的人工邊界，並選用**固定電位邊界條件**將邊界上的電位值設定為0。 |
| **混合邊界條件** | 第三類邊界條件: 混合邊界條件(Mixed Boundary Condition)或稱羅賓邊界條件 (Robin Boundary Condition) | 模擬更複雜的邊界行為，**同時考慮電位和電流的約束**。 | 常用於**側面和底部邊界**。該條件基於電位在遠處的理論衰減規律來約束邊界上的電位與通量。這種條件不需要太遠的邊界也能模擬無限遠處的行為，比**固定電位邊界條件**更好地維持數值穩定性，並顯著節省計算資源。例如：想模擬無窮遠處電位為0，則設定一個相對較近的邊界，並施加混合邊界條件，模擬電位在遠處的自然衰減。 |---

---

### FEM運行流程示範

#### 1.建立網格與設定邊界條件
| 1. 建立網格與設定邊界條件 |
| :------------- |
| ![圖1](https://raw.githubusercontent.com/cgrgncu/pyGimli_dev/main/ERT%E4%BB%8B%E7%B4%B9/image/(3)Figure_001.png)|
| 1.1. 設定研究區域(內網格)為等間距網格，設為區域2(Marker=2)。<br>1.2. 以1.2倍擴增全網格區域(增加外網格)，設為區域1(Marker=1)<br>1.3. 標註特定邊界編號以利控制邊界(BCMarker=-2、-1、1)。<br>1.4. 設定 **側面和底部邊界(BCMarker=-2)** 為 **混合邊界條件** <br> 1.5. 設定 **地表(BCMarker=-1)** 為 **絕緣邊界條件** <br> 研究區域邊界(BCMarker=1)輔助標示重點關注的範圍|

#### 2. 設定地層電阻率(`ρ`)
| 2. 設定地層電阻率(`ρ`) |
| :------------- |
| ![圖2](https://raw.githubusercontent.com/cgrgncu/pyGimli_dev/main/ERT%E4%BB%8B%E7%B4%B9/image/(3)Figure_002.png)|
| 2.1. 設定所有網格的電阻率為100歐姆米。使用log10刻度的色階來呈現電阻率。<br>2.2. 計算軟體自動將電阻率轉換至電導率進行後續計算。|

#### 3. 模擬電流注入時的電位分布
| 3. 模擬電流注入時的電位分布 |
| :------------- |
| ![圖3](https://raw.githubusercontent.com/cgrgncu/pyGimli_dev/main/ERT%E4%BB%8B%E7%B4%B9/image/(3)Figure_003.png)|
| 3.1. 設定指定位置「`S`=(1,0)」存在一個注入電流1安培的點源(`I` = 1 [A])。<br>3.2. 假設無窮遠處電位為零(步驟1.4)，求解出所有網格節點上的電位值，並繪製成分布圖。<br>3.3. 將電位的負梯度方向繪製為電流方向箭頭，疊加在分布圖上。<br> 3.4 此數值模擬不考慮接觸電阻(假設接觸電阻為零)。 |

#### 4. 模擬電流流出時的電位分布
| 4. 模擬電流流出時的電位分布 |
| :------------- |
| ![圖4](https://raw.githubusercontent.com/cgrgncu/pyGimli_dev/main/ERT%E4%BB%8B%E7%B4%B9/image/(3)Figure_004.png)|
| 4.1. 設定指定位置「`S`=(64,0)」存在一個流出電流1安培的點源(`I` = -1 [A])。<br>4.2. 假設無窮遠處電位為零(步驟1.4)，求解出所有網格節點上的電位值，並繪製成分布圖。<br>4.3. 將電位的負梯度方向繪製為電流方向箭頭，疊加在分布圖上。<br> 4.4 此數值模擬不考慮接觸電阻(假設接觸電阻為零)。 |

#### 5. 模擬「A點電流流入」且「B點電流流出」時的電位分布
| 5. 模擬「A點電流流入」且「B點電流流出」時的電位分布 |
| :------------- |
| ![圖5](https://raw.githubusercontent.com/cgrgncu/pyGimli_dev/main/ERT%E4%BB%8B%E7%B4%B9/image/(3)Figure_005.png)|
| 5.1. 利用步驟3與步驟4的電位分布，應用 **疊加原理** 推算出「A點電流流入」且「B點電流流出」時的電位分布，其中「`A`=(1,0)」，「`B`=(64,0)」。此時等同於模擬一個ERT的放電事件(1安培)。<br>5.2. 利用A點電位與B點電位計算ΔV_AB，在均質100歐姆米的情況下，A點至B點距離63[m]，電位差(ΔV_AB)為183.55[V]。數值的精確性取決於網格的大小和邊界條件的設置。<br>5.3. 因為假設接觸電阻為零，因此可計算AB點的等效電阻R_AB=183.55[V]/1[A]=183.55[Ω]。<br> 5.4 這表示使用普通電錶進行兩線式測量(Two-electrode measurement)，理論上可量到183.55[Ω]，但實際上會存在導線電阻與接觸電阻，因此野外使用兩線式量測時將大於此數值(這是兩線式量測本身的缺點，尤其是目標物電阻低或接觸電阻高時，量測將高估等效電阻)。 |

#### 6. 模擬「A點電流流入」且「B點電流流出」時，「M點與N點的電位差」
| 6. 模擬「A點電流流入」且「B點電流流出」時，「M點與N點的電位差」 |
| :------------- |
| ![圖6](https://raw.githubusercontent.com/cgrgncu/pyGimli_dev/main/ERT%E4%BB%8B%E7%B4%B9/image/(3)Figure_006.png)|
| 6.1. 利用步驟5的電位分布(存在電流I_AB=1[A]的電流源「`A`=(1,0)」，「`B`=(64,0)」)，計算「`M`=(22,0)」「`N`=(43,0)」的電位差(ΔV_MN=uₘ-uₙ)。注意，等於電錶的正端接M，參考端接N，不可反接。此時等同於模擬一筆ERT的觀測數據(A,B,M,N,I_AB,ΔV_MN/I_AB)。<br>6.2. 在均質100歐姆米的情況下，電位差(ΔV_MN)為0.7579[V]。數值的精確性取決於網格的大小和邊界條件的設置。<br>6.3. 不論接觸電阻是否為零，不會影響I_AB的量測(I_AB是由儀器控制注入的，接觸電阻會影響儀器為了注入該電流而需要的輸出電壓，但不影響您設定的I_AB數值。)與ΔV_MN的量測(因為電錶是高阻抗輸入，接觸電阻影響極小。)，等效電阻R_ABMN=0.7579[V]/1[A]=0.7579[Ω]。<br> 6.4 這就是四線式測量(Four-electrode measurement)的優點，可忽略導線電阻與接觸電阻對等效電阻量測的影響。 |
